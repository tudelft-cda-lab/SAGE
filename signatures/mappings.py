macro = {
    0: "MacroAttackStage.NONE",
    1: "MacroAttackStage.PASSIVE_RECON",
    2: "MacroAttackStage.ACTIVE_RECON",
    3: "MacroAttackStage.PRIVLEDGE_ESC",
    4: "MacroAttackStage.ENSURE_ACCESS",
    5: "MacroAttackStage.TARGETED_EXP",
    6: "MacroAttackStage.ZERO_DAY",
    7: "MacroAttackStage.DISRUPT",
    8: "MacroAttackStage.DISTROY",
    9: "MacroAttackStage.DISTORT",
    10: "MacroAttackStage.DISCLOSURE",
    11: "MacroAttackStage.DELIVERY"
}
macro_inv = {v: k for k, v in macro.items()}

micro = {
    0: "MicroAttackStage.INIT",
    1: "MicroAttackStage.TARGET_IDEN",
    2: "MicroAttackStage.SURFING",
    3: "MicroAttackStage.SOCIAL_ENGINEERING",
    4: "MicroAttackStage.HOST_DISC",
    5: "MicroAttackStage.SERVICE_DISC",
    6: "MicroAttackStage.VULN_DISC",
    7: "MicroAttackStage.INFO_DISC",
    10: "MicroAttackStage.USER_PRIV_ESC",
    11: "MicroAttackStage.ROOT_PRIV_ESC",
    12: "MicroAttackStage.NETWORK_SNIFFING",
    13: "MicroAttackStage.BRUTE_FORCE_CREDS",
    14: "MicroAttackStage.ACCT_MANIP",
    15: "MicroAttackStage.TRUSTED_ORG_EXP",
    16: "MicroAttackStage.PUBLIC_APP_EXP",
    17: "MicroAttackStage.REMOTE_SERVICE_EXP",
    18: "MicroAttackStage.SPEARPHISHING",
    19: "MicroAttackStage.SERVICE_SPECIFIC",
    20: "MicroAttackStage.DEFENSE_EVASION",
    21: "MicroAttackStage.COMMAND_AND_CONTROL",
    22: "MicroAttackStage.LATERAL_MOVEMENT",
    23: "MicroAttackStage.ARBITRARY_CODE_EXE",
    99: "MicroAttackStage.PRIV_ESC",
    100: "MicroAttackStage.END_POINT_DOS",
    101: "MicroAttackStage.NETWORK_DOS",
    102: "MicroAttackStage.SERVICE_STOP",
    103: "MicroAttackStage.RESOURCE_HIJACKING",
    104: "MicroAttackStage.DATA_DESTRUCTION",
    105: "MicroAttackStage.CONTENT_WIPE",
    106: "MicroAttackStage.DATA_ENCRYPTION",
    107: "MicroAttackStage.DEFACEMENT",
    108: "MicroAttackStage.DATA_MANIPULATION",
    109: "MicroAttackStage.DATA_EXFILTRATION",
    110: "MicroAttackStage.DATA_DELIVERY",
    111: "MicroAttackStage.PHISHING",
    999: "MicroAttackStage.NON_MALICIOUS"
}
micro_inv = {v: k for k, v in micro.items()}

micro2macro = {
    "MicroAttackStage.TARGET_IDEN": "MacroAttackStage.PASSIVE_RECON",
    "MicroAttackStage.SURFING": "MacroAttackStage.PASSIVE_RECON",
    "MicroAttackStage.SOCIAL_ENGINEERING": "MacroAttackStage.PASSIVE_RECON",
    "MicroAttackStage.HOST_DISC": "MacroAttackStage.ACTIVE_RECON",
    "MicroAttackStage.SERVICE_DISC": "MacroAttackStage.ACTIVE_RECON",
    "MicroAttackStage.VULN_DISC": "MacroAttackStage.ACTIVE_RECON",
    "MicroAttackStage.INFO_DISC": "MacroAttackStage.ACTIVE_RECON",
    "MicroAttackStage.PRIV_ESC": "MacroAttackStage.PRIVLEDGE_ESC",
    "MicroAttackStage.USER_PRIV_ESC": "MacroAttackStage.PRIVLEDGE_ESC",
    "MicroAttackStage.ROOT_PRIV_ESC": "MacroAttackStage.PRIVLEDGE_ESC",
    "MicroAttackStage.NETWORK_SNIFFING": "MacroAttackStage.PRIVLEDGE_ESC",
    "MicroAttackStage.BRUTE_FORCE_CREDS": "MacroAttackStage.PRIVLEDGE_ESC",
    "MicroAttackStage.ACCT_MANIP": "MacroAttackStage.PRIVLEDGE_ESC",
    "MicroAttackStage.TRUSTED_ORG_EXP": "MacroAttackStage.TARGETED_EXP",
    "MicroAttackStage.PUBLIC_APP_EXP": "MacroAttackStage.TARGETED_EXP",
    "MicroAttackStage.REMOTE_SERVICE_EXP": "MacroAttackStage.TARGETED_EXP",
    "MicroAttackStage.SPEARPHISHING": "MacroAttackStage.TARGETED_EXP",
    "MicroAttackStage.SERVICE_SPECIFIC": "MacroAttackStage.TARGETED_EXP",
    "MicroAttackStage.ARBITRARY_CODE_EXE": "MacroAttackStage.TARGETED_EXP",
    "MicroAttackStage.DEFENSE_EVASION": "MacroAttackStage.ENSURE_ACCESS",
    "MicroAttackStage.COMMAND_AND_CONTROL": "MacroAttackStage.ENSURE_ACCESS",
    "MicroAttackStage.LATERAL_MOVEMENT": "MacroAttackStage.ENSURE_ACCESS",
    "MicroAttackStage.END_POINT_DOS": "MacroAttackStage.DISRUPT",
    "MicroAttackStage.NETWORK_DOS": "MacroAttackStage.DISRUPT",
    "MicroAttackStage.SERVICE_STOP": "MacroAttackStage.DISRUPT",
    "MicroAttackStage.RESOURCE_HIJACKING": "MacroAttackStage.DISRUPT",
    "MicroAttackStage.DATA_DESTRUCTION": "MacroAttackStage.DISTROY",
    "MicroAttackStage.CONTENT_WIPE": "MacroAttackStage.DISTROY",
    "MicroAttackStage.DATA_ENCRYPTION": "MacroAttackStage.DISTORT",
    "MicroAttackStage.DEFACEMENT": "MacroAttackStage.DISTORT",
    "MicroAttackStage.DATA_MANIPULATION": "MacroAttackStage.DISTORT",
    "MicroAttackStage.DATA_EXFILTRATION": "MacroAttackStage.DISCLOSURE",
    "MicroAttackStage.DATA_DELIVERY": "MacroAttackStage.DELIVERY",
    "MicroAttackStage.NON_MALICIOUS": "MacroAttackStage.NONE"
}

mcols = list({(0.8941176470588236, 0.10196078431372549, 0.10980392156862745),
              (0.21568627450980393, 0.49411764705882355, 0.7215686274509804),
              (0.30196078431372547, 0.6862745098039216, 0.2901960784313726),
              (0.596078431372549, 0.3058823529411765, 0.6392156862745098), (1.0, 0.4980392156862745, 0.0),
              (0.6509803921568628, 0.33725490196078434, 0.1568627450980392),
              (0.9686274509803922, 0.5058823529411764, 0.7490196078431373), (0.6, 0.6, 0.6),
              (0.4, 0.7607843137254902, 0.6470588235294118),
              (0.9882352941176471, 0.5529411764705883, 0.3843137254901961),
              (0.5529411764705883, 0.6274509803921569, 0.796078431372549),
              (0.9058823529411765, 0.5411764705882353, 0.7647058823529411),
              (0.6509803921568628, 0.8470588235294118, 0.32941176470588235),
              (1.0, 0.8509803921568627, 0.1843137254901961),
              (0.8980392156862745, 0.7686274509803922, 0.5803921568627451),
              (0.7019607843137254, 0.7019607843137254, 0.7019607843137254),
              (0.12156862745098039, 0.4666666666666667, 0.7058823529411765),
              (1.0, 0.4980392156862745, 0.054901960784313725),
              (0.17254901960784313, 0.6274509803921569, 0.17254901960784313),
              (0.8392156862745098, 0.15294117647058825, 0.1568627450980392),
              (0.5803921568627451, 0.403921568627451, 0.7411764705882353),
              (0.5490196078431373, 0.33725490196078434, 0.29411764705882354),
              (0.8901960784313725, 0.4666666666666667, 0.7607843137254902),
              (0.4980392156862745, 0.4980392156862745, 0.4980392156862745),
              (0.7372549019607844, 0.7411764705882353, 0.13333333333333333),
              (0.09019607843137255, 0.7450980392156863, 0.8117647058823529),
              (0.10588235294117647, 0.6196078431372549, 0.4666666666666667),
              (0.8509803921568627, 0.37254901960784315, 0.00784313725490196),
              (0.4588235294117647, 0.4392156862745098, 0.7019607843137254),
              (0.9058823529411765, 0.1607843137254902, 0.5411764705882353),
              (0.4, 0.6509803921568628, 0.11764705882352941),
              (0.9019607843137255, 0.6705882352941176, 0.00784313725490196),
              (0.6509803921568628, 0.4627450980392157, 0.11372549019607843), (0.4, 0.4, 0.4),
              (0.4980392156862745, 0.788235294117647, 0.4980392156862745),
              (0.7450980392156863, 0.6823529411764706, 0.8313725490196079),
              (0.9921568627450981, 0.7529411764705882, 0.5254901960784314),
              (0.2196078431372549, 0.4235294117647059, 0.6901960784313725),
              (0.9411764705882353, 0.00784313725490196, 0.4980392156862745),
              (0.7490196078431373, 0.3568627450980392, 0.09019607843137253), (0.4, 0.4, 0.4),
              (0.984313725490196, 0.7058823529411765, 0.6823529411764706),
              (0.7019607843137254, 0.803921568627451, 0.8901960784313725),
              (0.8, 0.9215686274509803, 0.7725490196078432),
              (0.8705882352941177, 0.796078431372549, 0.8941176470588236),
              (0.996078431372549, 0.8509803921568627, 0.6509803921568628),
              (0.8980392156862745, 0.8470588235294118, 0.7411764705882353),
              (0.9921568627450981, 0.8549019607843137, 0.9254901960784314)})

small_mapping = {
    1: "tarID",
    2: "surf",
    4: "hostD",
    5: "serD",
    6: "vulnD",
    7: "infoD",
    10: "uPrivEsc",
    11: "rPrivEsc",
    12: "netSniff",
    13: "bfCred",
    14: "acctManip",
    15: "TOexp",
    16: "PAexp",
    17: "remoteexp",
    18: "sPhish",
    19: "servS",
    20: "evasion",
    21: "CnC",
    22: "lateral",
    23: "ACE",
    99: "privEsc",
    100: "endDOS",
    101: "netDOS",
    102: "serStop",
    103: "resHJ",
    104: "dDestruct",
    105: "cWipe",
    106: "dEncrypt",
    107: "deface",
    108: "dManip",
    109: "exfil",
    110: "delivery",
    111: "phish",
    999: "benign"
}
rev_smallmapping = dict([(value, key) for key, value in small_mapping.items()])

verbose_micro = {
    "INIT": "INITILIZE",
    "TARGET_IDEN": "TARGET IDENTIFICATION",
    "SURFING": "SURFING",
    "SOCIAL_ENGINEERING": "SOCIAL ENGINEERING",
    "HOST_DISC": "HOST DISCOVERY",
    "SERVICE_DISC": "SERVICE DISCOVERY",
    "VULN_DISC": "VULNERABILTY DISCOVERY",
    "INFO_DISC": "INFO DISCOVERY",
    "USER_PRIV_ESC": "USER PRIVILEGE ESCALATION",
    "ROOT_PRIV_ESC": "ROOT PRIVILEGE ESCALATION",
    "NETWORK_SNIFFING": "NETWORK SNIFFING",
    "BRUTE_FORCE_CREDS": "BRUTE FORCE CREDENTIALS",
    "ACCT_MANIP": "ACCOUNT MANIPULATION",
    "TRUSTED_ORG_EXP": "TRUSTED ORG. EXPLOIT",
    "PUBLIC_APP_EXP": "PUBLIC APP EXPLOIT",
    "REMOTE_SERVICE_EXP": "REMOTE SERVICE EXPLOIT",
    "SPEARPHISHING": "SPEAR PHISHING",
    "SERVICE_SPECIFIC": "SERVICE SPECIFIC",
    "DEFENSE_EVASION": "DEFENSE EVASION",
    "COMMAND_AND_CONTROL": "COMMAND AND CONTROL",
    "LATERAL_MOVEMENT": "LATERAL MOVEMENT",
    "ARBITRARY_CODE_EXE": "ARBITRARY CODE EXECUTION",
    "PRIV_ESC": "PRIVILEGE ESCALATION",
    "END_POINT_DOS": "END POINT DoS",
    "NETWORK_DOS": "NETWORK DoS",
    "SERVICE_STOP": "SERVICE STOP",
    "RESOURCE_HIJACKING": "RESOURCE HIJACKING",
    "DATA_DESTRUCTION": "DATA DESTRUCTION",
    "CONTENT_WIPE": "CONTENT WIPE",
    "DATA_ENCRYPTION": "DATA ENCRYPTION",
    "DEFACEMENT": "DEFACEMENT",
    "DATA_MANIPULATION": "DATA MANIPULATION",
    "DATA_EXFILTRATION": "DATA EXFILTRATION",
    "DATA_DELIVERY": "DATA DELIVERY",
    "PHISHING": "PHISHING",
    "NON_MALICIOUS": "NOT MALICIOUS"
}

ser_groups = dict({
    "http(s)": ["http", "https", "ddi-udp-1", "radan-http"],
    "wireless": ["wap-wsp"],
    "voip": ["sip", "sips"],
    "browser": ["vrml-multi-use"],
    "searchEng": ["search-agent"],
    "broadcast": ["ssdp", "snmp", "commplex-main", "icmpd", "wsdapi"],
    "nameserver": ["domain", "netbios-ns", "menandmice-dns"],
    "remoteAccess": ["ssh", "rfb", "us-cli", "ahsp", "spt-automation", "asf-rmcp", "xdmcp", "pcanywherestat", "esmagent",
                     "irdmi", "epmap", "wsman", "icslap", "ms-wbt-server", "appiq-mgmt", "sunrpc", "mosaicsyssvc1"],
    "surveillance": ["remoteware-cl", "ads-c", "syslog", "websm", "distinct", "irisa"],

    "hostingServer": ["cslistener", "etlservicemgr", "web2host"],

    "printService": ["pharos", "ipps"],
    # "sendEmail": ["smtp"],
    "migration": ["fs-agent"],
    "email": ["smtp", "imaps", "pop3", "imap", "pop3s", "submission"],
    "authentication": ["kerberos", "nv-video"],
    "ATCcomm": ["cpdlc", "fis"],

    "storage": ["http-alt", "ncube-lm", "postgresql", "mysql", "cm", "ms-sql-s", "ms-sql-m", "mongodb"],

    "dataSharing": ["ftp", "pcsync-https", "ndmp", "netbios-ssn", "microsoft-ds", "profinet-rt", "instantia"],
    "clocksync": ["ntp"],

    "unassigned": ["unknown", "Unknown"]
})
